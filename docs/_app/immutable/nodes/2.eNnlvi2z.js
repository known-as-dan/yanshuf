import"../chunks/DsnmJJEf.js";import"../chunks/A5sSkWgI.js";import{M as Ft,A as Rt,N as D,O as Y,P as d,x as t,C as V,D as h,F as Bt,K as l,I as n,G as y,J as i,L as _,Q as F,R as Vt,S as lt}from"../chunks/BjYh82n2.js";import{i as P}from"../chunks/DtJSq4Cy.js";import{m as Pt,l as Z,a as tt,e as et,h as f,c as Ht,s as at,i as Nt,b as ot,r as zt,d as At,t as S,f as rt,g as st,j as Et,k as Lt,n as Ot,o as St,p as it,q as It,u as qt,v as Gt}from"../chunks/Dd8zCZ81.js";import{g as nt}from"../chunks/CXZR86ed.js";var Jt=y('<span role="button" tabindex="0" class="-me-1 flex h-4 w-4 items-center justify-center rounded-full text-[10px] text-white/60 transition-colors hover:bg-white/20 hover:text-white" title="מחק תיקייה">&times;</span>'),Kt=y('<button type="button"><svg class="h-3.5 w-3.5 opacity-60" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"></path></svg> <!></button>'),Qt=y('<div class="flex gap-2"><input type="text" class="flex-1 rounded-lg border-border bg-surface-700 px-3 py-2 text-sm" placeholder="שם תיקייה..."/> <button type="button" class="rounded-lg bg-accent px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-accent-hover active:bg-accent/80">צור</button></div>'),Wt=y('<div class="py-16 text-center"><svg class="mx-auto mb-4 h-20 w-20 text-surface-500" viewBox="0 0 80 80" fill="none"><rect x="16" y="12" width="48" height="58" rx="6" stroke="currentColor" stroke-width="2" stroke-dasharray="5 3" opacity="0.5"></rect><rect x="28" y="7" width="24" height="10" rx="3" stroke="currentColor" stroke-width="2" stroke-dasharray="4 3" opacity="0.5"></rect><line x1="40" y1="32" x2="40" y2="56" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" opacity="0.4"></line><line x1="28" y1="44" x2="52" y2="44" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" opacity="0.4"></line></svg> <p class="text-gray-400"> </p> <p class="mt-1 text-sm text-gray-500">לחץ "בדיקה חדשה" להתחיל</p></div>'),Tt=lt('<svg class="h-4 w-4 animate-spin" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"></path></svg>'),Ut=lt('<svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>'),Xt=y('<div class="cursor-pointer rounded-xl border border-border/60 bg-surface-800 p-3.5 transition-all hover:border-border-light hover:bg-surface-700 active:border-border-light active:bg-surface-700" role="button" tabindex="0"><div class="mb-1.5 flex items-start justify-between"><div class="min-w-0 flex-1"><h3 class="truncate text-[15px] font-semibold text-white"> </h3> <p class="text-sm text-gray-500"> </p></div> <div class="flex gap-0.5"><button type="button" class="rounded-lg p-1.5 text-gray-500 transition-colors hover:bg-ok-dim hover:text-ok active:bg-ok-dim active:text-ok disabled:opacity-40" title="ייצוא לאקסל"><!></button> <button type="button" class="rounded-lg p-1.5 text-gray-500 transition-colors hover:bg-surface-600 hover:text-gray-300 active:bg-surface-600 active:text-gray-300" title="שכפל"><svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg></button> <button type="button" class="rounded-lg p-1.5 text-gray-500 transition-colors hover:bg-danger-dim hover:text-danger active:bg-danger-dim active:text-danger" title="מחק"><svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div></div> <div class="flex items-center justify-between text-xs text-gray-500"><span class="flex items-center gap-1"><svg class="h-3 w-3 opacity-50" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"></path></svg> </span> <span> </span></div></div>'),Yt=y('<div class="space-y-2.5"></div>'),Zt=y('<div class="mx-auto max-w-lg px-4 py-6"><div class="mb-8 flex flex-col items-center"><img src="/logo.svg" alt="בוחנת" class="mb-3 h-28 w-28"/> <h1 class="mb-0.5 text-2xl font-bold text-white">בוחנת</h1> <p class="text-sm text-gray-500">בדיקות תקופתיות PV</p></div> <button type="button" class="mb-6 flex w-full items-center justify-center gap-2 rounded-xl bg-accent px-6 py-3.5 text-base font-semibold text-white shadow-md shadow-accent/15 transition-all hover:bg-accent-hover hover:shadow-lg hover:shadow-accent/25 active:scale-[0.98]"><svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4"></path></svg> בדיקה חדשה</button> <div class="mb-4"><div class="mb-2 flex flex-wrap gap-1.5"><button type="button"> </button> <!> <button type="button" class="rounded-lg bg-surface-800 px-3.5 py-1.5 text-sm text-gray-500 transition-colors hover:bg-surface-700 hover:text-gray-400 active:bg-surface-700">+ תיקייה</button></div> <!></div> <!></div>');function te(H,ct){Rt(ct,!0),Pt();let x=D(Y(Z())),u=D(Y(tt())),v=D(null),R=D(!1),B=D("");function N(){d(x,Z(),!0),d(u,tt(),!0)}let I=F(()=>t(v)?t(x).filter(e=>e.folder===t(v)):t(x));function dt(){f("medium");const e=Ht(t(v)||"כללי");at(e),nt(`/report/${e.id}`)}function q(e){f("light"),nt(`/report/${e}`)}function vt(e){confirm("למחוק דוח זה לצמיתות?")&&(f("warning"),St(e),N())}function ut(e){f("light"),Ot(e),N()}let j=D(null);async function pt(e){if(!t(j)){d(j,e,!0),f("medium");try{const a=rt(e);if(!a)return;const r=a.inspection,p=[...r.checklist.filter(s=>s.status==="לא תקין").map(s=>{const g=s.sectionCode.split(".")[0];return{component:Et.find(b=>b.code===g)?.title??"",fault:s.description,location:`סעיף ${s.sectionCode}`,status:s.notes||""}}),...r.defects];await Lt(r,p),f("success")}catch(a){console.error("Export failed:",a),f("error")}finally{d(j,null)}}}function G(){const e=t(B).trim();e&&!t(u).includes(e)&&(f("light"),d(u,[...t(u),e],!0),st(t(u)),d(B,""),d(R,!1))}function J(e){const a=t(x).filter(r=>r.folder===e);if(a.length>0){if(!confirm(`תיקייה "${e}" מכילה ${a.length} דוחות. הדוחות יועברו לתיקיית "כללי". להמשיך?`))return;for(const r of a){const o=rt(r.id);o&&(o.folder="כללי",at(o))}}else if(!confirm(`למחוק את תיקיית "${e}"?`))return;d(u,t(u).filter(r=>r!==e),!0),st(t(u)),t(v)===e&&d(v,null),N()}function ht(e){try{return new Date(e).toLocaleDateString("he-IL",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return e}}let gt=F(()=>[...new Set([...t(u),...t(x).map(e=>e.folder)])]);var z=Zt(),K=l(n(z),2);K.__click=dt;var A=l(K,2),E=n(A),$=n(E);$.__click=()=>d(v,null);var ft=n($);i($);var Q=l($,2);et(Q,17,()=>t(gt),Nt,(e,a)=>{const r=F(()=>t(x).filter(m=>m.folder===t(a)).length),o=F(()=>t(v)===t(a)),p=F(()=>t(a)==="כללי");var s=Kt();s.__click=()=>d(v,t(o)?null:t(a),!0);var g=l(n(s)),k=l(g);{var b=m=>{var w=Jt();w.__click=C=>{C.stopPropagation(),J(t(a))},w.__keydown=C=>{C.key==="Enter"&&(C.stopPropagation(),J(t(a)))},h(m,w)};P(k,m=>{t(o)&&!t(p)&&m(b)})}i(s),V(()=>{ot(s,1,`flex items-center gap-1.5 rounded-lg px-3.5 py-1.5 text-sm font-medium transition-colors ${t(o)?"bg-accent text-white":"bg-surface-800 text-gray-400 hover:bg-surface-700 hover:text-gray-300 active:bg-surface-700"}`),_(g,` ${t(a)??""} (${t(r)??""}) `)}),h(e,s)});var xt=l(Q,2);xt.__click=()=>d(R,!t(R)),i(E);var bt=l(E,2);{var mt=e=>{var a=Qt(),r=n(a);zt(r),r.__keydown=p=>p.key==="Enter"&&G();var o=l(r,2);o.__click=G,i(a),At(r,()=>t(B),p=>d(B,p)),S(3,a,()=>It,()=>({duration:300,easing:it})),h(e,a)};P(bt,e=>{t(R)&&e(mt)})}i(A);var _t=l(A,2);{var yt=e=>{var a=Wt(),r=l(n(a),2),o=n(r,!0);i(r),Vt(2),i(a),V(()=>_(o,t(v)?"אין דוחות בתיקייה זו":"אין דוחות עדיין")),S(1,a,()=>qt,()=>({duration:400})),h(e,a)},kt=e=>{var a=Yt();et(a,23,()=>t(I),r=>r.id,(r,o,p)=>{var s=Xt();s.__click=()=>q(t(o).id),s.__keydown=c=>c.key==="Enter"&&q(t(o).id);var g=n(s),k=n(g),b=n(k),m=n(b,!0);i(b);var w=l(b,2),C=n(w);i(w),i(k);var W=l(k,2),M=n(W);M.__click=c=>{c.stopPropagation(),pt(t(o).id)};var wt=n(M);{var Ct=c=>{var O=Tt();h(c,O)},Dt=c=>{var O=Ut();h(c,O)};P(wt,c=>{t(j)===t(o).id?c(Ct):c(Dt,!1)})}i(M);var T=l(M,2);T.__click=c=>{c.stopPropagation(),ut(t(o).id)};var jt=l(T,2);jt.__click=c=>{c.stopPropagation(),vt(t(o).id)},i(W),i(g);var U=l(g,2),L=n(U),$t=l(n(L));i(L);var X=l(L,2),Mt=n(X);i(X),i(U),i(s),V(c=>{_(m,t(o).name),_(C,`${(t(o).siteName||"ללא שם אתר")??""} · ${t(o).inspectionDate??""}`),M.disabled=t(j)===t(o).id,_($t,` ${t(o).folder??""}`),_(Mt,`עודכן ${c??""}`)},[()=>ht(t(o).updatedAt)]),S(5,s,()=>Gt,()=>({y:12,duration:350,delay:Math.min(t(p)*50,250),easing:it})),h(r,s)}),i(a),h(e,a)};P(_t,e=>{t(I).length===0?e(yt):e(kt,!1)})}i(z),V(()=>{ot($,1,`rounded-lg px-3.5 py-1.5 text-sm font-medium transition-colors ${t(v)===null?"bg-accent text-white":"bg-surface-800 text-gray-400 hover:bg-surface-700 hover:text-gray-300 active:bg-surface-700"}`),_(ft,`הכל (${t(x).length??""})`)}),h(H,z),Bt()}Ft(["click","keydown"]);function ne(H){te(H,{})}export{ne as component};
